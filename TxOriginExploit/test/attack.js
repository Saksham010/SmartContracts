const {expect} = require("chai");
const {ethers} = require("hardhat");

describe('Attack', () => { 

    it("Attack contract should be the owner",async ()=>{

        //Get an address
        const [, addr1] = await ethers.getSigners();

        //Deploy good contract
        const GoodFactory = await ethers.getContractFactory("Good");
        const goodContract = await GoodFactory.connect(addr1).deploy();
        await goodContract.deployed();
        console.log("Good Contract address: ", goodContract.address);

        //Deploy Attack contract
        const AtackFactory = await ethers.getContractFactory("Attack");
        const attackContract = await AtackFactory.deploy(goodContract.address);
        await attackContract.deployed();
        console.log("Attack contract address: ",attackContract.address);

        //Attack    
        let tx =await attackContract.connect(addr1).attack();        
        await tx.wait();

        //Attack contract should be the new owner
        expect(await goodContract.owner()).to.equal(attackContract.address);
    });

});